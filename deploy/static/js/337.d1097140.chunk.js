"use strict";(self.webpackChunkpsbeauty=self.webpackChunkpsbeauty||[]).push([[337],{7731:function(i,n,e){e.r(n),e.d(n,{default:function(){return U}});var l,o=e(2982),d=e(885),s=e(2791),u="ClinicalCaseList_wrapper__6z8mo",a="ClinicalCaseList_header__cd6kG",t="ClinicalCaseList_chat-icon__mFbUz",v="ClinicalCaseList_chat-unread__3ifQn",r="ClinicalCaseList_inner__PUmWJ",c="ClinicalCaseList_filter__P5t0I",f="ClinicalCaseList_button__kS9of",g="ClinicalCaseList_funnel__JeTyT",m=e(687),C=e(897),h=e(7901),Z=e(3352),_=e(7432),p=e(9411),x=e(2313),j=e(8163),b=e(2103),I=e(8820),k=e(1413),y=e(168),L=e(7743),N=e(6586),P={},S=(0,L.Ps)(l||(l=(0,y.Z)(["\n  query GetTopCategories {\n    topCategories {\n      name\n      secondCategories {\n        name\n        categories {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));var T=e(595),w=e(7571),E=e(2333),M=e(9713),G=e(1288),Q=e(184),U=function(){var i,n,e,l,y,L,U,q,z,D,F,J,R,V,K=(0,I.aC)(),O=(0,j.Z)(),W=(0,s.useState)(!1),A=(0,d.Z)(W,2),B=A[0],H=A[1],X=(0,s.useState)(!1),Y=(0,d.Z)(X,2),$=Y[0],ii=Y[1],ni=(0,s.useRef)(""),ei=function(i){var n=(0,k.Z)((0,k.Z)({},P),i);return N.t(S,n)}(),li=(0,d.Z)(ei,2),oi=li[0],di=li[1],si=(0,M.ZG)(),ui=(0,d.Z)(si,2),ai=ui[0],ti=ui[1],vi=(0,T.fb)(),ri=(0,d.Z)(vi,2),ci=ri[0],fi=ri[1],gi=(0,E.k9)({fetchPolicy:"no-cache"}),mi=(0,d.Z)(gi,2),Ci=mi[0],hi=mi[1],Zi=(0,T.U)(),_i=(0,w.eO)({variables:{first:5,orderId:G.S.Desc,where:"\u6848\u4f8b\u8f2a\u64ad"}}),pi=$?(null===fi||void 0===fi||null===(i=fi.data)||void 0===i||null===(n=i.cases)||void 0===n?void 0:n.edges)||[]:(null===Zi||void 0===Zi||null===(e=Zi.data)||void 0===e||null===(l=e.cases)||void 0===l?void 0:l.edges)||[],xi=$?null===fi||void 0===fi||null===(y=fi.data)||void 0===y||null===(L=y.cases)||void 0===L?void 0:L.nodes:null===Zi||void 0===Zi||null===(U=Zi.data)||void 0===U||null===(q=U.cases)||void 0===q?void 0:q.nodes,ji=null===_i||void 0===_i||null===(z=_i.data)||void 0===z||null===(D=z.adImages)||void 0===D||null===(F=D.edges)||void 0===F||null===(J=F.map((function(i){var n,e,l,o,d;return{image:(null===(n=i.node)||void 0===n?void 0:n.image)||"",clinicId:(null===(e=i.node)||void 0===e?void 0:e.clinicId)||"",targetId:(null===(l=i.node)||void 0===l?void 0:l.targetId)||"",redirectType:null===(o=i.node)||void 0===o?void 0:o.redirectType,sort:(null===(d=i.node)||void 0===d?void 0:d.sort)||0}})))||void 0===J?void 0:J.sort((function(i,n){return i.sort-n.sort}));(0,s.useEffect)((function(){K.user.id&&ai()}),[K.user.id,ai]),(0,s.useEffect)((function(){B&&oi()}),[B]),(0,s.useEffect)((function(){K.user.id&&Ci()}),[K.user.id,Ci]);var bi=(0,s.useCallback)((function(){var i,n=(null===pi||void 0===pi||null===(i=pi[pi.length-1])||void 0===i?void 0:i.cursor)||null;($?fi:Zi).fetchMore({variables:{after:n},updateQuery:function(i,e){var l,d,s,u,a,t,v,r=e.fetchMoreResult;return!n||n===(null===ni||void 0===ni?void 0:ni.current)||null===r||void 0===r||null===(l=r.cases)||void 0===l||!l.edges||null===i||void 0===i||null===(d=i.cases)||void 0===d||!d.edges||(null===i||void 0===i||null===(s=i.cases)||void 0===s?void 0:s.edges.length)>pi.length?i:(r.cases.edges=[].concat((0,o.Z)((null===i||void 0===i||null===(u=i.cases)||void 0===u?void 0:u.edges)||[]),(0,o.Z)((null===r||void 0===r||null===(a=r.cases)||void 0===a?void 0:a.edges)||[])),r.cases.nodes=[].concat((0,o.Z)((null===(t=i.cases)||void 0===t?void 0:t.nodes)||[]),(0,o.Z)((null===r||void 0===r||null===(v=r.cases)||void 0===v?void 0:v.nodes)||[])),ni.current=n,r)}})}),[pi,Zi,fi]),Ii=(null===(R=ti.data)||void 0===R||null===(V=R.me)||void 0===V?void 0:V.consults)||[];return fi.error&&Zi.error?(0,Q.jsx)(b.Z.Error,{}):(0,Q.jsxs)(Q.Fragment,{children:[fi.loading&&Zi.loading?(0,Q.jsx)(b.Z.Loading,{}):(0,Q.jsxs)("div",{className:u,children:[(0,Q.jsxs)("div",{className:a,children:[(0,Q.jsx)(Z.Z,{onInputClick:function(){return O.toSearchList("")}}),(0,Q.jsxs)("div",{onClick:function(){K.user.clinic?O.toDoctorInbox():O.toMemberInbox()},children:[(0,Q.jsx)(p.Z,{name:"chat",className:t}),Ii.length>1&&Ii.map((function(i){var n;return null===i||void 0===i||null===(n=i.userInboxes)||void 0===n?void 0:n.some((function(i){return!(null!==i&&void 0!==i&&i.read)}))}))&&(0,Q.jsx)("div",{className:v})]})]}),(0,Q.jsxs)("div",{className:r,children:[(0,Q.jsx)(m.Z,{images:ji}),null===xi||void 0===xi?void 0:xi.map((function(i,n){var e,l,o,d,s,u;return(0,Q.jsx)(C.Z,{isCollected:(null===hi||void 0===hi||null===(e=hi.data)||void 0===e||null===(l=e.me)||void 0===l||null===(o=l.userCollectedCases)||void 0===o?void 0:o.some((function(n){return(null===n||void 0===n?void 0:n.id)===(null===i||void 0===i?void 0:i.id)})))||!1,title:(null===i||void 0===i?void 0:i.title)||"",clinic:(null===i||void 0===i||null===(d=i.clinic)||void 0===d?void 0:d.name)||"",clinicId:(null===i||void 0===i||null===(s=i.clinic)||void 0===s?void 0:s.id)||"",introduction:(null===i||void 0===i?void 0:i.description)||"",image:(null===i||void 0===i?void 0:i.image)||"",tags:null===i||void 0===i||null===(u=i.categories)||void 0===u?void 0:u.map((function(i){return(null===i||void 0===i?void 0:i.name)||""})),caseId:(null===i||void 0===i?void 0:i.id)||"",last:xi&&(null===xi||void 0===xi?void 0:xi.length)-1===n||!1,fetchMore:function(){var i,n,e;(null===Zi||void 0===Zi||null===(i=Zi.data)||void 0===i||null===(n=i.cases)||void 0===n||null===(e=n.pageInfo)||void 0===e?void 0:e.hasNextPage)&&bi()}},null===i||void 0===i?void 0:i.id)})),(0,Q.jsxs)("div",{className:c,children:[(0,Q.jsxs)(x.Z,{className:f,onClick:function(){return H(!0)},children:[(0,Q.jsx)(p.Z,{name:"funnel",className:g}),"\u5206\u985e\u7be9\u9078"]}),(0,Q.jsx)(_.Z,{open:B,onClose:function(){return H(!1)},getValue:function(i){if(0===i.length)return ii(!1);ci({variables:{searchKeys:i.map((function(i){return{eq:i.id||""}}))}}),ii(!0)},topCategoriesQuery:di,defaultValue:[]})]})]})]}),(0,Q.jsx)(h.Z,{})]})}}}]);
//# sourceMappingURL=337.d1097140.chunk.js.map