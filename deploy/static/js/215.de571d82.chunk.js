"use strict";(self.webpackChunkpsbeauty=self.webpackChunkpsbeauty||[]).push([[215],{6427:function(e,n,i){i.d(n,{Z:function(){return g}});var r=i(1413),t=i(4942),l=i(4925),o="Header_wrapper__e2tXX",s="Header_large__tDbDa",u="Header_small__U9DHq",c="Header_back__Chgho",d="Header_title__87Ruw",a="Header_has-back__h6eqr",v=i(1694),f=i.n(v),h=i(9411),_=i(6871),b=i(184),m=["style"],g=function(e){var n,i=e.style,v=void 0===i?{}:i,g=(0,l.Z)(e,m),p=(0,_.s0)(),x=(0,_.UO)().text;return(0,b.jsxs)("div",{className:f()(o,g.className,(n={},(0,t.Z)(n,s,g.title||g.children),(0,t.Z)(n,u,!g.title&&!g.leftArrow),n)),style:(0,r.Z)({},v),children:[g.leftArrow&&(0,b.jsx)("div",{onClick:function(){return g.redirect?g.redirect():p(x?-2:-1)},children:(0,b.jsx)(h.Z,{className:c,name:"LeftArrow"})}),g.title?(0,b.jsx)("div",{className:f()(d,(0,t.Z)({},a,g.leftArrow)),children:g.title}):g.children]})}},8865:function(e,n,i){i.d(n,{Z:function(){return v}});var r=i(4874),t=i(2791),l="MessageCard_wrapper__ySAWV",o="MessageCard_title__aTmZV",s="MessageCard_message__pvkOQ",u="MessageCard_head__q5s9l",c="MessageCard_tag__rzOuC",d="MessageCard_unread__09yTm",a=i(184),v=function(e){var n=Object.assign({},e),i=(0,r.Z)({}),v=i.containerRef,f=i.isVisible;return(0,t.useEffect)((function(){null!==n&&void 0!==n&&n.last&&f&&n.fetchMore&&(null===n||void 0===n||n.fetchMore())}),[n.last,n.fetchMore,f]),(0,a.jsxs)("div",{ref:n.last?v:null,className:l,onClick:n.onClick,children:[(0,a.jsxs)("div",{className:u,children:[(0,a.jsx)("div",{className:c,children:n.isOneOnOne?"1vs1":"\u8aee\u8a62"}),(0,a.jsx)("div",{className:o,children:n.title})]}),(0,a.jsx)("div",{className:s,children:n.message}),n.unread&&(0,a.jsx)("div",{className:d})]})}},4874:function(e,n,i){var r=i(885),t=i(2791);n.Z=function(e){var n=e.root,i=void 0===n?null:n,l=e.rootMargin,o=void 0===l?"0px":l,s=e.threshold,u=void 0===s?1:s,c=(0,t.useState)(!1),d=(0,r.Z)(c,2),a=d[0],v=d[1],f=(0,t.useRef)(null),h=(0,t.useCallback)((function(e){f.current=e,v(!!e)}),[]),_=(0,t.useState)(!1),b=(0,r.Z)(_,2),m=b[0],g=b[1];return(0,t.useEffect)((function(){if(a){var e=new IntersectionObserver((function(e){var n=(0,r.Z)(e,1)[0];g(n.isIntersecting)}),{root:i,rootMargin:o,threshold:u});return(null===f||void 0===f?void 0:f.current)&&e.observe(f.current),function(){(null===f||void 0===f?void 0:f.current)&&e.unobserve(f.current)}}}),[i,o,u,a]),{containerRef:h,isVisible:m}}},9713:function(e,n,i){i.d(n,{FH:function(){return f},ZG:function(){return h}});var r,t,l=i(1413),o=i(168),s=i(7743),u=i(6578),c=i(6586),d={},a=(0,s.Ps)(r||(r=(0,o.Z)(["\n  fragment UserInboxes on ConsultExt {\n    userInboxes {\n      id\n      read\n      readAt\n      topicId\n      replies {\n        content\n      }\n      clinic {\n        id\n        name\n      }\n    }\n  }\n"]))),v=(0,s.Ps)(t||(t=(0,o.Z)(["\n  query GetMemberInbox {\n    me {\n      consults {\n        id\n        subject\n        content\n        days\n        images\n        oneOnOne\n        ...UserInboxes\n      }\n    }\n  }\n  ","\n"])),a);function f(e){var n=(0,l.Z)((0,l.Z)({},d),e);return u.a(v,n)}function h(e){var n=(0,l.Z)((0,l.Z)({},d),e);return c.t(v,n)}},8134:function(e,n,i){i.r(n),i.d(n,{default:function(){return j}});var r=i(4942),t=i(885),l=i(2791),o=i(1694),s=i.n(o),u="MemberInbox_wrapper__iXF9d",c="MemberInbox_empty__gmagA",d="MemberInbox_text__lbNBr",a="MemberInbox_hide__WN0ib",v=i(6427),f=i(8865),h=i(9713),_=i(2103),b=i(2284),m=i(9062),g=i(8820),p=i(7724),x=i(6871),Z=i(184),j=function(){var e,n,i,o,j,O,C,y,M,I,N,k=(0,p.a)(),w=(0,g.aC)(),A=(0,x.s0)(),H=(0,l.useState)(!1),P=(0,t.Z)(H,2),R=P[0],U=P[1],F=(0,h.FH)({fetchPolicy:"no-cache"}),E=F.data,q=F.loading,D=F.error,S=F.refetch,V=(0,l.useRef)(null),Q=(0,l.useMemo)((function(){return(0,m.JU)(b.RZ,"inbox",w.user.id||"")}),[]);return(0,l.useEffect)((function(){return(0,m.cf)(Q,(function(e){console.log(e),e.exists()&&S()}))}),[]),q?(0,Z.jsx)(_.Z.Loading,{}):D?(0,Z.jsx)(_.Z.Error,{}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(v.Z,{title:"\u6536\u4ef6\u593e",leftArrow:!0,redirect:function(){R?U(!1):A(-1)}}),(0,Z.jsxs)("div",{className:s()(u,(i={},(0,r.Z)(i,c,((null===E||void 0===E||null===(e=E.me)||void 0===e||null===(n=e.consults)||void 0===n?void 0:n.length)||0)<=0),(0,r.Z)(i,a,R),i)),children:[((null===E||void 0===E||null===(o=E.me)||void 0===o||null===(j=o.consults)||void 0===j?void 0:j.length)||0)<=0&&(0,Z.jsx)("div",{className:d,children:"\u5c1a\u7121\u4fe1\u4ef6"}),null===E||void 0===E||null===(O=E.me)||void 0===O||null===(C=O.consults)||void 0===C?void 0:C.map((function(e){var n,i,r,t,l=null===e||void 0===e||null===(n=e.userInboxes)||void 0===n?void 0:n[0],o=(null===l||void 0===l?void 0:l.replies)&&(null===l||void 0===l||null===(i=l.replies[(null===l||void 0===l?void 0:l.replies.length)-1])||void 0===i?void 0:i.content)||"",s=o.includes("https://firebasestorage")?"\u5716\u7247":o;return(0,Z.jsx)(f.Z,{title:(null!==e&&void 0!==e&&e.oneOnOne?(null===l||void 0===l||null===(r=l.clinic)||void 0===r?void 0:r.name)||"":null===e||void 0===e?void 0:e.subject)||"",message:null!==e&&void 0!==e&&e.oneOnOne?s:(null===e||void 0===e?void 0:e.content)||"",isOneOnOne:null===e||void 0===e?void 0:e.oneOnOne,unread:null!==e&&void 0!==e&&e.oneOnOne?((null===l||void 0===l?void 0:l.readAt)||0)<=0:null===e||void 0===e||null===(t=e.userInboxes)||void 0===t?void 0:t.some((function(e){return!(null!==e&&void 0!==e&&e.read)})),onClick:function(){null!==e&&void 0!==e&&e.oneOnOne?k.toChatroom({id:(null===l||void 0===l?void 0:l.topicId)||""}):(U(!0),V.current=(null===e||void 0===e?void 0:e.userInboxes)||[])}},null===e||void 0===e?void 0:e.id)}))]}),(0,Z.jsxs)("div",{className:s()(u,(M={},(0,r.Z)(M,c,((null===(y=V.current)||void 0===y?void 0:y.length)||0)<=0),(0,r.Z)(M,a,!R),M)),children:[((null===(I=V.current)||void 0===I?void 0:I.length)||0)<=0&&(0,Z.jsx)("div",{className:d,children:"\u5c1a\u7121\u8a3a\u6240\u56de\u61c9"}),null===(N=V.current)||void 0===N?void 0:N.map((function(e){var n,i,r=(null===e||void 0===e?void 0:e.replies)&&(null===e||void 0===e||null===(n=e.replies[(null===e||void 0===e?void 0:e.replies.length)-1])||void 0===n?void 0:n.content)||"";return(0,Z.jsx)(f.Z,{unread:((null===e||void 0===e?void 0:e.readAt)||0)<=0,title:"\u4f86\u81ea"+((null===e||void 0===e||null===(i=e.clinic)||void 0===i?void 0:i.name)||""),message:r.includes("https://firebasestorage")?"\u5716\u7247":r,onClick:function(){k.toChatroom({id:(null===e||void 0===e?void 0:e.topicId)||""})}},null===e||void 0===e?void 0:e.id)}))]})]})}},6586:function(e,n,i){i.d(n,{t:function(){return c}});var r=i(9388),t=i(2791),l=i(3124),o=i(6578),s=i(5046),u=["refetch","reobserve","fetchMore","updateQuery","startPolling","subscribeToMore"];function c(e,n){var i=(0,o.A)((0,s.x)(n&&n.client),e),c=(0,t.useRef)(),d=c.current?(0,l.J)(n,c.current):n,a=i.useQuery((0,r.pi)((0,r.pi)({},d),{skip:!c.current})),v=a.observable.options.initialFetchPolicy||i.getDefaultFetchPolicy(),f=Object.assign(a,{called:!!c.current}),h=(0,t.useMemo)((function(){for(var e={},n=function(n){var r=f[n];e[n]=function(){return c.current||(c.current=Object.create(null),i.forceUpdate()),r.apply(this,arguments)}},r=0,t=u;r<t.length;r++){n(t[r])}return e}),[]);return Object.assign(f,h),[(0,t.useCallback)((function(e){c.current=e?(0,r.pi)((0,r.pi)({},e),{fetchPolicy:e.fetchPolicy||v}):{fetchPolicy:v};var n=i.asyncUpdate().then((function(e){return Object.assign(e,h)}));return n.catch((function(){})),n}),[]),f]}}}]);
//# sourceMappingURL=215.de571d82.chunk.js.map